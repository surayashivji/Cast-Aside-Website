!function(){function o(t){this.controller=t.controller,this.definition=t.definition,this.tick=0,this._respawn()}function n(t){this.controller=t.controller,this.definition=t.definition}function t(i){if(i=i||{},this.phase=0,this.run=!1,this.cache={},null==i.container&&(console.warn("SiriWaveJS: no container defined, using body"),i.container=document.body),this.style=i.style||"ios",this.container=i.container,this.width=i.width||window.getComputedStyle(this.container).width.replace("px",""),this.height=i.height||window.getComputedStyle(this.container).height.replace("px",""),this.ratio=i.ratio||window.devicePixelRatio||1,this.cache.width=this.ratio*this.width,this.cache.height=this.ratio*this.height,this.cache.height2=this.cache.height/2,this.cache.width2=this.cache.width/2,this.cache.width4=this.cache.width/4,this.cache.heightMax=this.cache.height2-4,this.amplitude=i.amplitude||1,this.speed=i.speed||.2,this.frequency=i.frequency||6,this.color=this._hex2rgb(i.color||"#fff"),this.speedInterpolationSpeed=i.speedInterpolationSpeed||.005,this.amplitudeInterpolationSpeed=i.amplitudeInterpolationSpeed||.05,this.cache.interpolation={speed:this.speed,amplitude:this.amplitude},this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.canvas.width=this.cache.width,this.canvas.height=this.cache.height,i.cover)this.canvas.style.width=this.canvas.style.height="100%";else{this.canvas.style.width=this.cache.width/this.ratio+"px",this.canvas.style.height=this.cache.height/this.ratio+"px";var e=this;this.debounceResize=debounce(function(t){e.width=i.width||window.getComputedStyle(e.container).width.replace("px",""),e.height=i.height||window.getComputedStyle(e.container).height.replace("px",""),e.ratio=i.ratio||window.devicePixelRatio||1,e.cache.width=e.ratio*e.width,e.cache.height=e.ratio*e.height,e.cache.height2=e.cache.height/2,e.cache.width2=e.cache.width/2,e.cache.width4=e.cache.width/4,e.cache.heightMax=e.cache.height2-4,e.canvas.width=e.cache.width,e.canvas.height=e.cache.height,e.canvas.style.width=e.cache.width/e.ratio+"px",e.canvas.style.height=e.cache.height/e.ratio+"px"},10),window.addEventListener("resize",this.debounceResize)}this.curves=[];var t=0,h=0;if("ios9"===this.style)for(;t<o.prototype.definition.length;t++)for(h=0;h<3*Math.random()|0;h++)this.curves.push(new o({controller:this,definition:o.prototype.definition[t]}));else for(;t<n.prototype.definition.length;t++)this.curves.push(new n({controller:this,definition:n.prototype.definition[t]}));this.container.insertBefore(this.canvas,this.container.firstElementChild),i.autostart&&this.start()}o.prototype._respawn=function(){this.amplitude=.3+.7*Math.random(),this.seed=Math.random(),this.openClass=2+3*Math.random()|0},o.prototype._ypos=function(t){var i=this.tick,e=-1*Math.abs(Math.sin(i))*this.controller.amplitude*this.amplitude*this.controller.cache.heightMax*Math.pow(1/(1+Math.pow(this.openClass*t,2)),2);return Math.abs(e)<.001&&this._respawn(),e},o.prototype._draw=function(t){var i=this.controller.ctx;this.tick+=this.controller.speed*(1-.5*Math.sin(this.seed*Math.PI)),i.beginPath();for(var e,h,o=this.controller.cache.width2+(-this.controller.cache.width4+this.seed*this.controller.cache.width2),n=this.controller.cache.height2,a=null,s=-3;s<=3;s+=.01)e=o+s*this.controller.cache.width4,h=n+(t||1)*this._ypos(s),a=a||e,i.lineTo(e,h);var c=Math.abs(this._ypos(0)),r=i.createRadialGradient(o,n,1.15*c,o,n,.3*c);r.addColorStop(0,"rgba("+this.definition.color+", 0.4)"),r.addColorStop(1,"rgba("+this.definition.color+", 0.2)"),i.fillStyle=r,i.lineTo(a,n),i.closePath(),i.fill()},o.prototype.draw=function(){this._draw(-1),this._draw(1)},o.prototype.definition=[{color:"32,133,252"},{color:"94,252,169"},{color:"253,71,103"}],(n.prototype._globAttenuationEquation=function(t){return null==n.prototype._globAttenuationEquation.cache[t]&&(n.prototype._globAttenuationEquation.cache[t]=Math.pow(4/(4+Math.pow(t,4)),4)),n.prototype._globAttenuationEquation.cache[t]}).cache={},n.prototype._xpos=function(t){return this.controller.cache.width2+t*this.controller.cache.width4},n.prototype._ypos=function(t){var i=this.controller.cache.heightMax*this.controller.amplitude/this.definition.attenuation;return this.controller.cache.height2+this._globAttenuationEquation(t)*i*Math.sin(this.controller.frequency*t-this.controller.phase)},n.prototype.draw=function(){var t=this.controller.ctx;t.moveTo(0,0),t.beginPath(),t.strokeStyle="rgba("+this.controller.color+","+this.definition.opacity+")",t.lineWidth=this.definition.lineWidth;for(var i=-2;i<=2;i+=.01){var e=this._ypos(i);1.9<=Math.abs(i)&&(e=this.controller.cache.height2),t.lineTo(this._xpos(i),e)}t.stroke()},n.prototype.definition=[{attenuation:-2,lineWidth:1,opacity:.1},{attenuation:-6,lineWidth:1,opacity:.2},{attenuation:4,lineWidth:1,opacity:.4},{attenuation:2,lineWidth:1,opacity:.6},{attenuation:1,lineWidth:1.5,opacity:1}],t.prototype._hex2rgb=function(t){t=t.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(t,i,e,h){return i+i+e+e+h+h});var i=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return i?parseInt(i[1],16).toString()+","+parseInt(i[2],16).toString()+","+parseInt(i[3],16).toString():null},t.prototype._interpolate=function(t){increment=this[t+"InterpolationSpeed"],Math.abs(this.cache.interpolation[t]-this[t])<=increment?this[t]=this.cache.interpolation[t]:this.cache.interpolation[t]>this[t]?this[t]+=increment:this[t]-=increment},t.prototype._clear=function(){this.ctx.globalCompositeOperation="destination-out",this.ctx.fillRect(0,0,this.cache.width,this.cache.height),this.ctx.globalCompositeOperation="source-over"},t.prototype._draw=function(){for(var t=0,i=this.curves.length;t<i;t++)this.curves[t].draw()},t.prototype._startDrawCycle=function(){!1!==this.run&&(this._clear(),this._interpolate("amplitude"),this._interpolate("speed"),this._draw(),this.phase=(this.phase+Math.PI*this.speed)%(2*Math.PI),window.requestAnimationFrame?window.requestAnimationFrame(this._startDrawCycle.bind(this)):setTimeout(this._startDrawCycle.bind(this),20))},t.prototype.start=function(){this.phase=0,this.run=!0,this._startDrawCycle()},t.prototype.stop=function(){this.phase=0,this.run=!1},t.prototype.setSpeed=function(t,i){this.cache.interpolation.speed=t},t.prototype.setAmplitude=function(t){this.cache.interpolation.amplitude=Math.max(Math.min(t,1),0)},"function"==typeof define&&define.amd?define(function(){return t}):window.SiriWave=t}();